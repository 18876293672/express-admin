<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-type" content="text/html; charset=utf-8" />
    <meta name="author" content="Simeon Velichkov" />
    <meta name="copyright" content="Simeon Velichkov" />
    <meta name="robots" content="follow,index" />
    <meta name="title" content="Express Admin - MySql, MariaDB, SQLite and PostgreSQL database admin for NodeJS built with Express and Bootstrap" />
    <meta name="keywords" content="express admin, express, mysql, mariadb, sqlite, postgresql, pg, admin, node, nodejs, expressjs, bootstrap" lang="en-us" />
    <meta name="description" content="Express Admin - MySql, MariaDB, SQLite and PostgreSQL database admin for NodeJS built with Express and Bootstrap" />

    <title>Express Admin</title>

    <link href="v2/css/github1.css" media="all" rel="stylesheet" type="text/css" />
    <link href="v2/css/github2.css" media="all" rel="stylesheet" type="text/css" />
    <link href="v2/css/style.css" media="all" rel="stylesheet" type="text/css" />
    <link rel="shortcut icon" href="v2/css/images/favicon.ico" />

    <script src="examples/jslib/jquery-1.9.1.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="v2/js/scrollpsy.js" type="text/javascript" charset="utf-8"></script>
    <script src="v2/js/events.js" type="text/javascript" charset="utf-8"></script>
</head>
<body>
<div class="container">

    <div class="repository-with-sidebar repo-container with-full-navigation">
        <div class="repository-content context-loader-container">

            <section id="readme" class="clearfix announce instapaper_body md">
                <article class="markdown-body entry-content" itemprop="mainContentOfPage">
<div class="file"><h1>
<a name="express-admin" class="anchor" href="#express-admin" aria-hidden="true"><span class="octicon octicon-link"></span></a>Express Admin</h1>

<p>Express Admin is a NodeJS tool for easy creation of user friendly administrative interface for MySQL, MariaDB, SQLite and PostgreSQL databases.</p>

<p>It's built with: <a href="http://twitter.github.io/hogan.js/">Hogan.js</a> (<a href="https://github.com/janl/mustache.js/">mustache.js</a>), <a href="http://expressjs.com/">Express</a>, <a href="https://github.com/felixge/node-mysql">mysql</a> and <a href="http://twitter.github.io/bootstrap/">Bootstrap</a>.</p>

<p>The configuration is done through hand editing <code>json</code> files, although in the future there might be some kind of a GUI tool for that.</p>

<h3>
<a name="features" class="anchor" href="#features" aria-hidden="true"><span class="octicon octicon-link"></span></a>Features</h3>

<ul>
<li>All types of sql table relationships</li>
<li>Internationalization</li>
<li>Custom views and events</li>
<li>All kinds of browser side libraries and controls</li>
<li>All themes from <a href="http://bootswatch.com/">Bootswatch</a>
</li>
</ul><h3>
<a name="resources" class="anchor" href="#resources" aria-hidden="true"><span class="octicon octicon-link"></span></a>Resources</h3>

<ul>
<li><a href="http://www.youtube.com/watch?v=1CdoCB96QNk">Introductory Screencast</a></li>
<li><a href="https://github.com/simov/express-admin">GitHub Repository</a></li>
<li><a href="https://github.com/simov/express-admin-examples">Examples</a></li>
</ul><p><br /></p><hr /></div><div class="file"><h2>
<a name="install" class="anchor" href="#install" aria-hidden="true"><span class="octicon octicon-link"></span></a>Install</h2>

<h3>
<a name="get-the-module" class="anchor" href="#get-the-module" aria-hidden="true"><span class="octicon octicon-link"></span></a>Get the module</h3>

<div class="highlight highlight-bash"><pre><span class="nv">$ </span><span class="o">[</span>sudo<span class="o">]</span> npm install <span class="o">[</span>-g<span class="o">]</span> express-admin
<span class="c"># PostgreSQL only: run this inside the express-admin folder</span>
<span class="nv">$ </span>npm install pg@2.8.2
<span class="c"># SQLite only: run this inside the express-admin folder</span>
<span class="nv">$ </span>npm install sqlite3@2.2.0
</pre></div>

<h3>
<a name="create-a-project" class="anchor" href="#create-a-project" aria-hidden="true"><span class="octicon octicon-link"></span></a>Create a project</h3>

<p>Depending on how you installed it creating a project is simple</p>

<div class="highlight highlight-bash"><pre><span class="nv">$ </span>admin path/to/config/dir
<span class="c"># or</span>
<span class="nv">$ </span>node path/to/express-admin/app.js path/to/config/dir
</pre></div>

<p>Either way the config path should exist. If it doesn't contains any config files in it already you'll be prompted to add required information for your database, server port and admin account credentials.</p>

<p>After that you can navigate to <code>localhost:[specified port]</code> and see your admin up and running.</p>

<p>The next step is to configure it.</p><p><br /></p><hr /></div><div class="file"><h2>
<a name="configuration" class="anchor" href="#configuration" aria-hidden="true"><span class="octicon octicon-link"></span></a>Configuration</h2>

<h3>
<a name="configjson" class="anchor" href="#configjson" aria-hidden="true"><span class="octicon octicon-link"></span></a>config.json</h3>

<p>The application's configuration is stored inside the <code>config.json</code> file.</p>

<ul>
<li>The <code>mysql</code> key accepts any option from the <a href="https://github.com/felixge/node-mysql#connection-options">node-mysql's connection options</a>.</li>
<li>When using PostgreSQL, the <code>pg</code> key will accept any option from the <a href="https://github.com/brianc/node-postgres">node-postgres</a> connection options.</li>
<li>When using SQLite, the <code>sqlite</code> key will contain only a <code>database</code> key with the absolute path to the database set as a value.</li>
</ul><div class="highlight highlight-js"><pre><span class="p">{</span>
    <span class="s2">"mysql"</span><span class="o">:</span> <span class="p">{</span> <span class="c1">// or "pg" or "sqlite"</span>
        <span class="s2">"database"</span><span class="o">:</span> <span class="s2">"express-admin-examples"</span><span class="p">,</span>
        <span class="s2">"user"</span><span class="o">:</span> <span class="s2">"liolio"</span><span class="p">,</span>
        <span class="s2">"password"</span><span class="o">:</span> <span class="s2">"karamba"</span>
        <span class="c1">// "schema": "schema-name"</span>
    <span class="p">},</span>
    <span class="s2">"server"</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">"port"</span><span class="o">:</span> <span class="mi">3000</span>
    <span class="p">},</span>
    <span class="s2">"app"</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">"layouts"</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
        <span class="s2">"themes"</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
        <span class="s2">"languages"</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
        <span class="s2">"root"</span><span class="o">:</span> <span class="s2">"/admin"</span><span class="p">,</span>
        <span class="s2">"upload"</span><span class="o">:</span> <span class="s2">"/upload/folder"</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>

<ul>
<li>
<strong>mysql | pg | sqlite</strong> - connection options

<ul>
<li>
<strong>database</strong> - name of the database to use for this connection (sqlite: absolute path to a database file)</li>
<li>
<strong>user</strong> - database user to authenticate with</li>
<li>
<strong>password</strong> - password for that database user</li>
<li>
<strong>schema</strong> - used only with PostgreSQL (default: "public")</li>
</ul>
</li>
<li>
<strong>server</strong> - server configuration

<ul>
<li>
<strong>port</strong> - the server's port number (default: 3000)</li>
</ul>
</li>
<li>
<strong>app</strong> - admin application configuration

<ul>
<li>
<strong>layouts</strong> - toggle the layout button</li>
<li>
<strong>themes</strong> - toggle the themes button</li>
<li>
<strong>languages</strong> - toggle the languages button</li>
<li>
<strong>root</strong> - root location for the admin (used <strong>only</strong> when embedding - see the docs)</li>
<li>
<strong>upload</strong> - absolute path to the upload folder (default: "public/upload")</li>
</ul>
</li>
</ul><p><br /></p><hr /></div><div class="file"><h2>
<a name="configuration" class="anchor" href="#configuration" aria-hidden="true"><span class="octicon octicon-link"></span></a>Configuration</h2>

<h3>
<a name="settingsjson" class="anchor" href="#settingsjson" aria-hidden="true"><span class="octicon octicon-link"></span></a>settings.json</h3>

<p>All settings related to the default Express Admin views are in the <code>settings.json</code> file which is automatically generated with default values at first start up.</p>

<div class="highlight highlight-js"><pre><span class="s2">"table_name"</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">"slug"</span><span class="o">:</span> <span class="s2">"unique-slug"</span><span class="p">,</span>
    <span class="s2">"table"</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">"name"</span><span class="o">:</span> <span class="s2">"table_name"</span><span class="p">,</span>
        <span class="s2">"pk"</span><span class="o">:</span> <span class="s2">"pk_name"</span><span class="p">,</span>
        <span class="s2">"verbose"</span><span class="o">:</span> <span class="s2">"Verbose Name"</span>
    <span class="p">},</span>
    <span class="s2">"columns"</span><span class="o">:</span> <span class="p">[</span>
        <span class="p">{...},</span> <span class="c1">// see column definition below</span>
        <span class="c1">// { "manyToMany" ... } // see 'Many to Many' documentation</span>
    <span class="p">],</span>
    <span class="s2">"mainview"</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">"show"</span><span class="o">:</span> <span class="kc">true</span>
    <span class="p">},</span>
    <span class="s2">"listview"</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">"order"</span><span class="o">:</span> <span class="p">{</span>
            <span class="s2">"column_name1"</span><span class="o">:</span> <span class="s2">"asc"</span><span class="p">,</span>
            <span class="s2">"column_name2"</span><span class="o">:</span> <span class="s2">"desc"</span>
        <span class="p">},</span>
        <span class="s2">"page"</span><span class="o">:</span> <span class="mi">25</span><span class="p">,</span>
        <span class="s2">"filter"</span><span class="o">:</span> <span class="p">[</span><span class="s2">"column_name1"</span><span class="p">,</span> <span class="s2">"column_name2"</span> <span class="p">...]</span>
    <span class="p">},</span>
    <span class="s2">"editview"</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">"readonly"</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
        <span class="c1">// "manyToOne": { ... }, // see 'Many to One' documentation</span>
        <span class="c1">// "oneToOne": { ... } // see 'One to One' documentation</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>

<p><code>settings.json</code> contains a list of objects representing the database's tables. Each <code>table</code> object contains:</p>

<ul>
<li>
<strong>slug</strong> - unique slug among all other tables</li>
<li>
<strong>table</strong> - contains table's settings

<ul>
<li>
<strong>name</strong> - table's database name (typically you won't change this)</li>
<li>
<strong>pk</strong> - table's primary key (it will be set automatically)</li>
<li>
<strong>verbose</strong> - table's name used inside the admin's user interface</li>
</ul>
</li>
<li>
<strong>columns</strong> - array of all table's columns. To reorder the columns appearance cut the entire column object and paste it on the desired position in this array</li>
<li>
<strong>mainview</strong> - table's settings for admin's root page

<ul>
<li>
<strong>show</strong> - toggle table visibility inside the mainview table's list. Typically you want to hide tables that will be edited as <a href="#many-to-one">inlines</a> of other tables, or tables that are used as links for <a href="#many-to-many">many-to-many</a> relationships</li>
</ul>
</li>
<li>
<strong>listview</strong> - table's settings for the admin's listview

<ul>
<li>
<strong>order</strong> - list of columns by which to sort and their respective order direction</li>
<li>
<strong>page</strong> - how many records to show per page</li>
<li>
<strong>filter</strong> - list of column names to enable for filtering</li>
</ul>
</li>
<li>
<strong>editview</strong> - settings specifically related to the page where the record is edited

<ul>
<li>
<strong>readonly</strong> - this will omit the save and delete buttons at the bottom of the page effectively making the table's records readonly</li>
<li>
<strong>manyToOne</strong> - see <code>Many to One</code> documentation</li>
<li>
<strong>oneToOne</strong> - see <code>One to One</code> documentation</li>
</ul>
</li>
</ul><h4>
<a name="column" class="anchor" href="#column" aria-hidden="true"><span class="octicon octicon-link"></span></a>Column</h4>

<p>Each <code>table</code> object contains an array of colums. Each <code>column</code> object have:</p>

<div class="highlight highlight-js"><pre><span class="p">{</span>
    <span class="s2">"verbose"</span><span class="o">:</span> <span class="s2">"Verbose Name"</span><span class="p">,</span>
    <span class="s2">"name"</span><span class="o">:</span> <span class="s2">"column_name"</span><span class="p">,</span>
    <span class="s2">"control"</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">"text"</span><span class="o">:</span> <span class="kc">true</span>
    <span class="p">},</span>
    <span class="s2">"type"</span><span class="o">:</span> <span class="s2">"varchar(45)"</span><span class="p">,</span>
    <span class="s2">"allowNull"</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
    <span class="s2">"defaultValue"</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span>
    <span class="s2">"listview"</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">"show"</span><span class="o">:</span> <span class="kc">true</span>
    <span class="p">},</span>
    <span class="s2">"editview"</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">"show"</span><span class="o">:</span> <span class="kc">true</span>
    <span class="p">},</span>
    <span class="c1">// "oneToMany": { ... }, // see 'One to Many' documentation</span>
<span class="p">}</span>
</pre></div>

<ul>
<li>
<strong>verbose</strong> - column's name inside the admin's UI</li>
<li>
<strong>name</strong> - column's database name (typically you won't change this)</li>
<li>
<p><strong>control</strong> - one of these</p>

<div class="highlight highlight-js"><pre><span class="p">{</span><span class="s2">"text"</span><span class="o">:</span> <span class="kc">true</span><span class="p">}</span> <span class="c1">// input type="text"</span>
<span class="p">{</span><span class="s2">"textarea"</span><span class="o">:</span> <span class="kc">true</span><span class="p">}</span> <span class="c1">// textarea</span>
<span class="p">{</span><span class="s2">"textarea"</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span> <span class="s2">"editor"</span><span class="o">:</span> <span class="s2">"some-class"</span><span class="p">}</span> <span class="c1">// html editor (see the docs)</span>
<span class="p">{</span><span class="s2">"number"</span><span class="o">:</span> <span class="kc">true</span><span class="p">}</span> <span class="c1">// input type="number"</span>
<span class="p">{</span><span class="s2">"date"</span><span class="o">:</span> <span class="kc">true</span><span class="p">}</span> <span class="c1">// datepicker</span>
<span class="p">{</span><span class="s2">"time"</span><span class="o">:</span> <span class="kc">true</span><span class="p">}</span> <span class="c1">// timepicker</span>
<span class="p">{</span><span class="s2">"datetime"</span><span class="o">:</span> <span class="kc">true</span><span class="p">}</span> <span class="c1">// datetimepicker</span>
<span class="p">{</span><span class="s2">"year"</span><span class="o">:</span> <span class="kc">true</span><span class="p">}</span> <span class="c1">// yearpicker</span>
<span class="p">{</span><span class="s2">"file"</span><span class="o">:</span> <span class="kc">true</span><span class="p">}</span> <span class="c1">// input type="file" (uploads to file system)</span>
<span class="p">{</span><span class="s2">"file"</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span> <span class="s2">"binary"</span><span class="o">:</span> <span class="kc">true</span><span class="p">}</span> <span class="c1">// input type="file" (uploads to blob|bytea fields)</span>
<span class="p">{</span><span class="s2">"radio"</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span> <span class="s2">"options"</span><span class="o">:</span> <span class="p">[</span><span class="s2">"True"</span><span class="p">,</span><span class="s2">"False"</span><span class="p">]}</span> <span class="c1">// input type="radio"</span>
<span class="p">{</span><span class="s2">"select"</span><span class="o">:</span> <span class="kc">true</span><span class="p">}</span> <span class="c1">// select (used for one-to-many relationships)</span>
<span class="p">{</span><span class="s2">"select"</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span> <span class="s2">"multiple"</span><span class="o">:</span> <span class="kc">true</span><span class="p">}</span> <span class="c1">// select multiple (used for many-to-many relationships)</span>
<span class="p">{</span><span class="s2">"select"</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span> <span class="s2">"options"</span><span class="o">:</span> <span class="p">[</span><span class="s2">"one"</span><span class="p">,</span><span class="s2">"two"</span><span class="p">]}</span> <span class="c1">// select with static options</span>
</pre></div>
</li>
<li><p><strong>type</strong> - column's data type (typically you won't change this)</p></li>
<li>
<strong>allowNull</strong> - allowed to be null inside the database</li>
<li>
<strong>defaultValue</strong> - currently not used</li>
<li>
<strong>listview</strong> - settings about how this column should behave in admin's listview

<ul>
<li>
<strong>show</strong> - column's visibility inside the listview which is the page where all records from the table are listed. Typically you want to see only colums that have short and meaningful data describing the record clearly. Primary key columns and columns that contain large amount of text should be hidden in this view</li>
</ul>
</li>
<li>
<strong>editview</strong> - settings about how this column should behave in admin's editview

<ul>
<li>
<strong>show</strong> - column's visibility inside the listview which is the page where a record can be edited.<br><strong>All auto increment columns should be hidden!</strong><br><strong>Foreign keys for inline tables should be hidden!</strong><br>
Columns that can't be <code>null</code> inside the database, can't be hidden here as this will result in a mysql error when insert/update the record</li>
</ul>
</li>
<li>
<strong>oneToMany</strong> - see <code>One to Many</code> documentation</li>
</ul><p><br /></p><hr /></div><div class="file"><h2>
<a name="configuration" class="anchor" href="#configuration" aria-hidden="true"><span class="octicon octicon-link"></span></a>Configuration</h2>

<h3>
<a name="customjson" class="anchor" href="#customjson" aria-hidden="true"><span class="octicon octicon-link"></span></a>custom.json</h3>

<p>All objects in this file are user created. The <code>public</code> key is related entirely to inclusion of custom <em>static files</em>. It's possible to have an object only with public key inside as well as object with only <code>app</code> key in it.</p>

<div class="highlight highlight-js"><pre><span class="s2">"unique-key-here"</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">"app"</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">"path"</span><span class="o">:</span> <span class="s2">"/absolute/path/to/custom/app.js"</span><span class="p">,</span>
        <span class="s2">"slug"</span><span class="o">:</span> <span class="s2">"unique-slug"</span><span class="p">,</span>
        <span class="s2">"verbose"</span><span class="o">:</span> <span class="s2">"Verbose Name"</span><span class="p">,</span>
        <span class="s2">"mainview"</span><span class="o">:</span> <span class="p">{</span>
            <span class="s2">"show"</span><span class="o">:</span> <span class="kc">true</span>
        <span class="p">}</span>
    <span class="p">},</span>
    <span class="s2">"public"</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">"local"</span><span class="o">:</span> <span class="p">{</span>
            <span class="s2">"path"</span><span class="o">:</span> <span class="s2">"/absolute/path/to/custom/public/dir"</span><span class="p">,</span>
            <span class="s2">"css"</span><span class="o">:</span> <span class="p">[</span>
                <span class="s2">"/relative/to/above/global.css"</span>
            <span class="p">],</span>
            <span class="s2">"js"</span><span class="o">:</span> <span class="p">[</span>
                <span class="s2">"/relative/to/above/global.js"</span>
            <span class="p">]</span>
        <span class="p">},</span>
        <span class="s2">"external"</span><span class="o">:</span> <span class="p">{</span>
            <span class="s2">"css"</span><span class="o">:</span> <span class="p">[</span>
                <span class="s2">"//absolute/url/external.css"</span>
            <span class="p">],</span>
            <span class="s2">"js"</span><span class="o">:</span> <span class="p">[</span>
                <span class="s2">"//absolute/url/external.js"</span>
            <span class="p">]</span>
        <span class="p">}</span>
    <span class="p">},</span>
    <span class="s2">"events"</span><span class="o">:</span> <span class="s2">"/absolute/path/to/custom/events.js"</span>
<span class="p">}</span>
</pre></div>

<ul>
<li>
<strong>app</strong> - expressjs application

<ul>
<li>
<strong>path</strong> - absolute path to the custom view's <code>app.js</code> file</li>
<li>
<strong>slug</strong> - entry point for all routes in this custom app</li>
<li>
<strong>verbose</strong> - view's name inside the admin's UI</li>
<li>
<strong>mainview</strong> - settings related to the mainview

<ul>
<li>
<strong>show</strong> - include/exclude from admin's list of custom views</li>
</ul>
</li>
</ul>
</li>
<li>
<strong>public</strong> - custom static files

<ul>
<li>
<strong>local</strong> - local files

<ul>
<li>
<strong>path</strong> - absolute path to the static files location</li>
<li>
<strong>css</strong> - list of stylesheet files to be included</li>
<li>
<strong>js</strong> - list of javascript files to be included</li>
</ul>
</li>
<li>
<strong>external</strong> - external files

<ul>
<li>
<strong>css</strong> - list of stylesheet urls to be included</li>
<li>
<strong>js</strong> - list of javascript urls to be included</li>
</ul>
</li>
</ul>
</li>
<li>
<strong>events</strong> - path to file containing event hooks</li>
</ul><p>See the custom view's documentation and the examples.</p><p><br /></p><hr /></div><div class="file"><h2>
<a name="relationships" class="anchor" href="#relationships" aria-hidden="true"><span class="octicon octicon-link"></span></a>Relationships</h2>

<h3>
<a name="one-to-many" class="anchor" href="#one-to-many" aria-hidden="true"><span class="octicon octicon-link"></span></a>One to Many</h3>

<p><a href="images/one-to-many.png" target="_blank"><img src="images/one-to-many.png" alt="One to Many" style="max-width:100%;"></a></p>

<p>In <code>settings.json</code> find the table you are searching for and under its columns find the foreign key columnt by its name key. Inside the column's object insert <code>oneToMany</code> key. Also don't forget to change the column's control type to <code>select</code>.</p>

<div class="highlight highlight-js"><pre><span class="s2">"control"</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">"select"</span><span class="o">:</span> <span class="kc">true</span>
<span class="p">},</span>
<span class="s2">"oneToMany"</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">"table"</span><span class="o">:</span> <span class="s2">"user"</span><span class="p">,</span>
    <span class="s2">"pk"</span><span class="o">:</span> <span class="s2">"id"</span><span class="p">,</span>
    <span class="s2">"columns"</span><span class="o">:</span> <span class="p">[</span>
        <span class="s2">"firstname"</span><span class="p">,</span>
        <span class="s2">"lastname"</span>
    <span class="p">]</span>
<span class="p">}</span>
</pre></div>

<ul>
<li>
<strong>oneToMany</strong> - contains information about the table that this foreign key references

<ul>
<li>
<strong>table</strong> - name of the table that you are referencing</li>
<li>
<strong>pk</strong> - name of the referenced table's primary key column</li>
<li>
<strong>columns</strong> - array of columns that you want to see for each record of the referenced table</li>
</ul>
</li>
</ul><p><br /></p><hr /></div><div class="file"><h2>
<a name="relationships" class="anchor" href="#relationships" aria-hidden="true"><span class="octicon octicon-link"></span></a>Relationships</h2>

<h3>
<a name="many-to-many" class="anchor" href="#many-to-many" aria-hidden="true"><span class="octicon octicon-link"></span></a>Many to Many</h3>

<p><a href="images/many-to-many.png" target="_blank"><img src="images/many-to-many.png" alt="Many to Many" style="max-width:100%;"></a></p>

<p>In <code>settings.json</code> find the table you are searching for and insert this object inside its columns array.</p>

<div class="highlight highlight-js"><pre><span class="p">{</span>
    <span class="s2">"verbose"</span><span class="o">:</span> <span class="s2">"Recipe Types"</span><span class="p">,</span>
    <span class="s2">"name"</span><span class="o">:</span> <span class="s2">"recipe_type"</span><span class="p">,</span>
    <span class="s2">"control"</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">"select"</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
        <span class="s2">"multiple"</span><span class="o">:</span> <span class="kc">true</span>
    <span class="p">},</span>
    <span class="s2">"type"</span><span class="o">:</span> <span class="s2">"int(11)"</span><span class="p">,</span>
    <span class="s2">"allowNull"</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
    <span class="s2">"listview"</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">"show"</span><span class="o">:</span> <span class="kc">false</span>
    <span class="p">},</span>
    <span class="s2">"editview"</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">"show"</span><span class="o">:</span> <span class="kc">true</span>
    <span class="p">},</span>
    <span class="s2">"manyToMany"</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">"link"</span><span class="o">:</span> <span class="p">{</span>
            <span class="s2">"table"</span><span class="o">:</span> <span class="s2">"recipe_has_recipe_types"</span><span class="p">,</span>
            <span class="s2">"parentPk"</span><span class="o">:</span> <span class="s2">"recipe_id"</span><span class="p">,</span>
            <span class="s2">"childPk"</span><span class="o">:</span> <span class="s2">"recipe_type_id"</span>
        <span class="p">},</span>
        <span class="s2">"ref"</span><span class="o">:</span> <span class="p">{</span>
            <span class="s2">"table"</span><span class="o">:</span> <span class="s2">"recipe_type"</span><span class="p">,</span>
            <span class="s2">"pk"</span><span class="o">:</span> <span class="s2">"id"</span><span class="p">,</span>
            <span class="s2">"columns"</span><span class="o">:</span> <span class="p">[</span>
                <span class="s2">"title"</span>
            <span class="p">]</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>

<ul>
<li>
<strong>verbose</strong> - exactly as a regular column this is the name that's shown inside the admin UI for this column</li>
<li>
<strong>name</strong> - should be unique among all other columns in this table</li>
<li>
<strong>control</strong> - the control type (you won't change this)</li>
<li>
<strong>type</strong> - you won't change this</li>
<li>
<strong>allowNull</strong> - indicates whether you'll be able to save a record without selecting any item from the referenced table or not</li>
<li>
<strong>listview</strong> - 

<ul>
<li>
<strong>show</strong> - include or exclude this column from the listview</li>
</ul>
</li>
<li>
<strong>editview</strong> - 

<ul>
<li>
<strong>show</strong> - include or exclude this column from the editview</li>
</ul>
</li>
<li>
<strong>manyToMany</strong> - indicates that this is not a regular table column

<ul>
<li>
<strong>link</strong> - linking table information

<ul>
<li>
<strong>table</strong> - name of the link table</li>
<li>
<strong>parentPk</strong> - name of the primary key for the parent table</li>
<li>
<strong>childPk</strong> - name of the primary key for the child table</li>
</ul>
</li>
<li>
<strong>ref</strong> - information about the referenced table

<ul>
<li>
<strong>table</strong> - name of the table that you are referencing</li>
<li>
<strong>pk</strong> - name of the referenced table's primary key columns</li>
<li>
<strong>columns</strong> - array of columns that you want to see for each record of the referenced table</li>
</ul>
</li>
</ul>
</li>
</ul><p><br /></p><hr /></div><div class="file"><h2>
<a name="relationships" class="anchor" href="#relationships" aria-hidden="true"><span class="octicon octicon-link"></span></a>Relationships</h2>

<h3>
<a name="many-to-one" class="anchor" href="#many-to-one" aria-hidden="true"><span class="octicon octicon-link"></span></a>Many to One</h3>

<p><a href="images/many-to-one.png" target="_blank"><img src="images/many-to-one.png" alt="Many to One" style="max-width:100%;"></a></p>

<p>In <code>settings.json</code> find the table you are searching for and under its <code>editview</code> key add a <code>manyToOne</code> key.</p>

<div class="highlight highlight-js"><pre><span class="s2">"manyToOne"</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">"repair"</span><span class="o">:</span> <span class="s2">"car_id"</span><span class="p">,</span>
    <span class="s2">"driver"</span><span class="o">:</span> <span class="s2">"car_id"</span>
<span class="p">}</span>
</pre></div>

<ul>
<li>
<strong>manyToOne</strong> - contains information about the tables that are referencing this one

<ul>
<li>
<strong>table:fk</strong> - Inside there is a list of key-value pairs where the <code>key</code> is the name of the table that is referencing this one and the <code>value</code> is its foreign key</li>
</ul>
</li>
</ul><p><br /></p><hr /></div><div class="file"><h2>
<a name="relationships" class="anchor" href="#relationships" aria-hidden="true"><span class="octicon octicon-link"></span></a>Relationships</h2>

<h3>
<a name="one-to-one" class="anchor" href="#one-to-one" aria-hidden="true"><span class="octicon octicon-link"></span></a>One to One</h3>

<p><a href="images/one-to-one.png" target="_blank"><img src="images/one-to-one.png" alt="One to One" style="max-width:100%;"></a></p>

<p>In <code>settings.json</code> find the table you are searching for and under its <code>editview</code> key add a <code>oneToOne</code> key.</p>

<div class="highlight highlight-js"><pre><span class="s2">"oneToOne"</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">"address"</span><span class="o">:</span> <span class="s2">"user_id"</span><span class="p">,</span>
    <span class="s2">"phone"</span><span class="o">:</span> <span class="s2">"user_id"</span>
<span class="p">}</span>
</pre></div>

<ul>
<li>
<strong>oneToOne</strong> - contains information about the tables that are referencing this one

<ul>
<li>
<strong>table:fk</strong> - Inside there is a list of key-value pairs where the <code>key</code> is the name of the table that is referencing this one and the <code>value</code> is its foreign key</li>
</ul>
</li>
</ul><p><br /></p><hr /></div><div class="file"><h2>
<a name="compound-primary-key" class="anchor" href="#compound-primary-key" aria-hidden="true"><span class="octicon octicon-link"></span></a>Compound Primary Key</h2>

<p><a href="images/compound-primary-key.png" target="_blank"><img src="images/compound-primary-key.png" alt="Compound Primary Key" style="max-width:100%;"></a></p>

<p>In <code>settings.json</code> each table can be configured to have multiple primary keys through its <code>pk</code> field (this is set automatically on project's first run)</p>

<div class="highlight highlight-js"><pre><span class="s2">"table"</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">"name"</span><span class="o">:</span> <span class="s2">"tbl"</span><span class="p">,</span>
    <span class="s2">"pk"</span><span class="o">:</span> <span class="p">[</span>
        <span class="s2">"id1"</span><span class="p">,</span>
        <span class="s2">"id2"</span>
    <span class="p">],</span>
    <span class="s2">"verbose"</span><span class="o">:</span> <span class="s2">"tbl"</span>
<span class="p">}</span>
</pre></div>

<h3>
<a name="compound-one-to-many" class="anchor" href="#compound-one-to-many" aria-hidden="true"><span class="octicon octicon-link"></span></a>Compound One to Many</h3>

<p><a href="images/compound-one-to-many.png" target="_blank"><img src="images/compound-one-to-many.png" alt="Compound One to Many" style="max-width:100%;"></a></p>

<p>In case One to Many table relationship is referenced by multiple foreign keys, the regular <a href="#one-to-many">One to Many</a> setting can't be used, as it expects to be put inside an existing column in <code>settings.json</code>
Therefore the following <em>fake</em> column entry must be added to the <code>columns</code> array (similar to how <a href="#many-to-many">Many to Many</a> relationship is configured)
The <code>fk</code> key specifies the foreign keys in this table that references the other one</p>

<div class="highlight highlight-js"><pre><span class="p">{</span>
    <span class="s2">"verbose"</span><span class="o">:</span> <span class="s2">"otm"</span><span class="p">,</span>
    <span class="s2">"name"</span><span class="o">:</span> <span class="s2">"otm"</span><span class="p">,</span>
    <span class="s2">"control"</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">"select"</span><span class="o">:</span> <span class="kc">true</span>
    <span class="p">},</span>
    <span class="s2">"type"</span><span class="o">:</span> <span class="s2">"varchar(45)"</span><span class="p">,</span>
    <span class="s2">"allowNull"</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
    <span class="s2">"listview"</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">"show"</span><span class="o">:</span> <span class="kc">true</span>
    <span class="p">},</span>
    <span class="s2">"editview"</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">"show"</span><span class="o">:</span> <span class="kc">true</span>
    <span class="p">},</span>
    <span class="s2">"fk"</span><span class="o">:</span> <span class="p">[</span>
        <span class="s2">"otm_id1"</span><span class="p">,</span>
        <span class="s2">"otm_id2"</span>
    <span class="p">],</span>
    <span class="s2">"oneToMany"</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">"table"</span><span class="o">:</span> <span class="s2">"otm"</span><span class="p">,</span>
        <span class="s2">"pk"</span><span class="o">:</span> <span class="p">[</span>
            <span class="s2">"id1"</span><span class="p">,</span>
            <span class="s2">"id2"</span>
        <span class="p">],</span>
        <span class="s2">"columns"</span><span class="o">:</span> <span class="p">[</span>
            <span class="s2">"name"</span>
        <span class="p">]</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>

<h3>
<a name="compound-many-to-many" class="anchor" href="#compound-many-to-many" aria-hidden="true"><span class="octicon octicon-link"></span></a>Compound Many to Many</h3>

<p><a href="images/compound-many-to-many.png" target="_blank"><img src="images/compound-many-to-many.png" alt="Compound Many to Many" style="max-width:100%;"></a></p>

<p>In case tables with multiple primary keys are part of a Many to Many table relationship, the regular <a href="#many-to-many">Many to Many</a> setting is used, but additionally the <code>parentPk</code>, <code>childPk</code> and the <code>pk</code> field inside <code>ref</code> can be set to array of keys to accommodate that design</p>

<div class="highlight highlight-js"><pre><span class="p">{</span>
    <span class="s2">"verbose"</span><span class="o">:</span> <span class="s2">"mtm"</span><span class="p">,</span>
    <span class="s2">"name"</span><span class="o">:</span> <span class="s2">"mtm"</span><span class="p">,</span>
    <span class="s2">"control"</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">"select"</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
        <span class="s2">"multiple"</span><span class="o">:</span> <span class="kc">true</span>
    <span class="p">},</span>
    <span class="s2">"type"</span><span class="o">:</span> <span class="s2">"varchar(45)"</span><span class="p">,</span>
    <span class="s2">"allowNull"</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
    <span class="s2">"listview"</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">"show"</span><span class="o">:</span> <span class="kc">true</span>
    <span class="p">},</span>
    <span class="s2">"editview"</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">"show"</span><span class="o">:</span> <span class="kc">true</span>
    <span class="p">},</span>
    <span class="s2">"manyToMany"</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">"link"</span><span class="o">:</span> <span class="p">{</span>
            <span class="s2">"table"</span><span class="o">:</span> <span class="s2">"tbl_has_mtm"</span><span class="p">,</span>
            <span class="s2">"parentPk"</span><span class="o">:</span> <span class="p">[</span>
                <span class="s2">"tbl_id1"</span><span class="p">,</span>
                <span class="s2">"tbl_id2"</span>
            <span class="p">],</span>
            <span class="s2">"childPk"</span><span class="o">:</span> <span class="p">[</span>
                <span class="s2">"mtm_id1"</span><span class="p">,</span>
                <span class="s2">"mtm_id2"</span>
            <span class="p">]</span>
        <span class="p">},</span>
        <span class="s2">"ref"</span><span class="o">:</span> <span class="p">{</span>
            <span class="s2">"table"</span><span class="o">:</span> <span class="s2">"mtm"</span><span class="p">,</span>
            <span class="s2">"pk"</span><span class="o">:</span> <span class="p">[</span>
                <span class="s2">"id1"</span><span class="p">,</span>
                <span class="s2">"id2"</span>
            <span class="p">],</span>
            <span class="s2">"columns"</span><span class="o">:</span> <span class="p">[</span>
                <span class="s2">"name"</span>
            <span class="p">]</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>

<h3>
<a name="compound-many-to-one" class="anchor" href="#compound-many-to-one" aria-hidden="true"><span class="octicon octicon-link"></span></a>Compound Many to One</h3>

<p><a href="images/compound-many-to-one.png" target="_blank"><img src="images/compound-many-to-one.png" alt="Compound Many to One" style="max-width:100%;"></a></p>

<p>Same as the regular <a href="#many-to-one">Many to One</a> setting, plus it can contain multiple foreign keys that references this table</p>

<div class="highlight highlight-js"><pre><span class="s2">"manyToOne"</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">"mto"</span><span class="o">:</span> <span class="p">[</span>
        <span class="s2">"tbl_id1"</span><span class="p">,</span>
        <span class="s2">"tbl_id2"</span>
    <span class="p">]</span>
<span class="p">}</span>
</pre></div>

<h3>
<a name="compound-one-to-one" class="anchor" href="#compound-one-to-one" aria-hidden="true"><span class="octicon octicon-link"></span></a>Compound One to One</h3>

<p>Same as the regular <a href="#one-to-one">One to One</a> setting, plus it can contain multiple foreign keys that references this table</p>

<div class="highlight highlight-js"><pre><span class="s2">"oneToOne"</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">"oto"</span><span class="o">:</span> <span class="p">[</span>
        <span class="s2">"tbl_id1"</span><span class="p">,</span>
        <span class="s2">"tbl_id2"</span>
    <span class="p">]</span>
<span class="p">}</span>
</pre></div><p><br /></p><hr /></div><div class="file"><h2>
<a name="editors" class="anchor" href="#editors" aria-hidden="true"><span class="octicon octicon-link"></span></a>Editors</h2>

<h3>
<a name="ckeditor" class="anchor" href="#ckeditor" aria-hidden="true"><span class="octicon octicon-link"></span></a>CKEditor</h3>

<h4>
<a name="install" class="anchor" href="#install" aria-hidden="true"><span class="octicon octicon-link"></span></a>Install</h4>

<p>You should either download CKEditor from <a href="http://ckeditor.com">ckeditor.com</a> or use it directly from <a href="http://cdnjs.com">cdnjs.com</a> <code>//cdnjs.cloudflare.com/ajax/libs/ckeditor/4.2/ckeditor.js</code></p>

<h4>
<a name="settingsjson" class="anchor" href="#settingsjson" aria-hidden="true"><span class="octicon octicon-link"></span></a>settings.json</h4>

<p>In <code>settings.json</code> add additional <code>editor</code> property to the column's <code>control</code> type key specifiyng the class name for this editor instance.</p>

<div class="highlight highlight-js"><pre><span class="s2">"control"</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">"textarea"</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="s2">"editor"</span><span class="o">:</span> <span class="s2">"class-name"</span>
<span class="p">}</span>
</pre></div>

<h4>
<a name="customjson" class="anchor" href="#customjson" aria-hidden="true"><span class="octicon octicon-link"></span></a>custom.json</h4>

<p>In <code>custom.json</code> add a unique key for your custom stuff.</p>

<div class="highlight highlight-js"><pre><span class="s2">"unique-key-here"</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">"public"</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">"local"</span><span class="o">:</span> <span class="p">{</span>
            <span class="s2">"path"</span><span class="o">:</span> <span class="s2">"/absolute/path/to/custom/files/location"</span><span class="p">,</span>
            <span class="s2">"js"</span><span class="o">:</span> <span class="p">[</span>
                <span class="s2">"/relative/to/above/path/ckeditor/ckeditor.js"</span><span class="p">,</span>
                <span class="s2">"/relative/to/above/path/my-custom.js"</span>
            <span class="p">]</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>

<ul>
<li>
<strong>public</strong> - static files configuration

<ul>
<li>
<strong>path</strong> - absolute path to the static files location</li>
<li>
<strong>css</strong> - list of stylesheet files to be included</li>
<li>
<strong>js</strong> - list of javascript files to be included</li>
</ul>
</li>
</ul><h4>
<a name="my-customjs" class="anchor" href="#my-customjs" aria-hidden="true"><span class="octicon octicon-link"></span></a>my-custom.js</h4>

<p>Your custom editor is initialized here. It's just plain javascript/jquery and you can write whatever you want to. However there are a few requirements.</p>

<div class="highlight highlight-js"><pre><span class="nx">$</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">CKEDITOR</span> <span class="o">!==</span> <span class="s1">'undefined'</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">CKEDITOR</span><span class="p">.</span><span class="nx">replaceAll</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">textarea</span><span class="p">,</span> <span class="nx">config</span><span class="p">)</span> <span class="p">{</span>
            <span class="c1">// exclude textareas that are inside hidden inline rows</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="nx">textarea</span><span class="p">).</span><span class="nx">parents</span><span class="p">(</span><span class="s1">'tr'</span><span class="p">).</span><span class="nx">hasClass</span><span class="p">(</span><span class="s1">'blank'</span><span class="p">))</span> <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
            <span class="c1">// textareas with this class name will get the default configuration</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">textarea</span><span class="p">.</span><span class="nx">className</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s1">'class-name'</span><span class="p">)</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
            <span class="c1">// all other textareas won't be initialized as ckeditors</span>
            <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
        <span class="p">});</span>
    <span class="p">}</span>
<span class="p">});</span>

<span class="c1">// executed each time an inline is added</span>
<span class="kd">function</span> <span class="nx">onAddInline</span> <span class="p">(</span><span class="nx">rows</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">CKEDITOR</span> <span class="o">!==</span> <span class="s1">'undefined'</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// for each of the new rows containing textareas</span>
        <span class="nx">$</span><span class="p">(</span><span class="s1">'textarea'</span><span class="p">,</span> <span class="nx">rows</span><span class="p">).</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">index</span><span class="p">)</span> <span class="p">{</span>
            <span class="c1">// get the DOM instance</span>
            <span class="kd">var</span> <span class="nx">textarea</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">)[</span><span class="mi">0</span><span class="p">];</span>
            <span class="c1">// textareas with this class name will get the default configuration</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">textarea</span><span class="p">.</span><span class="nx">className</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s1">'class-name'</span><span class="p">)</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">return</span> <span class="nx">CKEDITOR</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="nx">textarea</span><span class="p">);</span>
            <span class="c1">// all other textareas won't be initialized as ckeditors</span>
            <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
        <span class="p">});</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>

<p>Here <code>class-name</code> is the same class name you specified in <code>settings.json</code> for this column.</p>

<p>The <code>CKEDITOR.replaceAll</code> loop throgh all textareas on the page and filter out only those that need to be initialized as ckeditors. The most important bit is that you should always exclude the textareas that are inside the hidden row for an inline record. That's easy because all of them have class <code>blank</code> on their containing row.</p>

<p>The hidden textareas are initialized when they are appended to the document body. The <code>onAddInline</code> is an event like global function that is called each time an inline record is appended to the list of records. The <code>rows</code> parameters contain all table rows that's been added. Again we loop through all of them and initialize only those textareas that have the class we specified in <code>settings.json</code>.</p><p><br /></p><hr /></div><div class="file"><h2>
<a name="editors" class="anchor" href="#editors" aria-hidden="true"><span class="octicon octicon-link"></span></a>Editors</h2>

<h3>
<a name="tinymce" class="anchor" href="#tinymce" aria-hidden="true"><span class="octicon octicon-link"></span></a>TinyMCE</h3>

<h4>
<a name="install" class="anchor" href="#install" aria-hidden="true"><span class="octicon octicon-link"></span></a>Install</h4>

<p>You should either download TinyMCE from <a href="http://www.tinymce.com">tinymce.com</a> or use it directly from <a href="http://cdnjs.com">cdnjs.com</a> <code>//cdnjs.cloudflare.com/ajax/libs/tinymce/3.5.8/tiny_mce.js</code></p>

<h4>
<a name="settingsjson" class="anchor" href="#settingsjson" aria-hidden="true"><span class="octicon octicon-link"></span></a>settings.json</h4>

<p>In <code>settings.json</code> add additional <code>editor</code> property to the column's <code>control</code> type key specifiyng the class name for this editor instance.</p>

<div class="highlight highlight-js"><pre><span class="s2">"control"</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">"textarea"</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="s2">"editor"</span><span class="o">:</span> <span class="s2">"class-name"</span>
<span class="p">}</span>
</pre></div>

<h4>
<a name="customjson" class="anchor" href="#customjson" aria-hidden="true"><span class="octicon octicon-link"></span></a>custom.json</h4>

<p>In <code>custom.json</code> add a unique key for your custom stuff.</p>

<div class="highlight highlight-js"><pre><span class="s2">"unique-key-here"</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">"public"</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">"local"</span><span class="o">:</span> <span class="p">{</span>
            <span class="s2">"path"</span><span class="o">:</span> <span class="s2">"/absolute/path/to/custom/files/location"</span><span class="p">,</span>
            <span class="s2">"js"</span><span class="o">:</span> <span class="p">[</span>
                <span class="s2">"/relative/to/above/path/tinymce/jscripts/tiny_mce/tiny_mce.js"</span><span class="p">,</span>
                <span class="s2">"/relative/to/above/path/tinymce/jscripts/tiny_mce/jquery.tinymce.min.js"</span><span class="p">,</span>
                <span class="s2">"/relative/to/above/path/my-custom.js"</span>
            <span class="p">]</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>

<ul>
<li>
<strong>public</strong> - static files configuration

<ul>
<li>
<strong>path</strong> - absolute path to the static files location</li>
<li>
<strong>css</strong> - list of stylesheet files to be included</li>
<li>
<strong>js</strong> - list of javascript files to be included</li>
</ul>
</li>
</ul><h4>
<a name="my-customjs" class="anchor" href="#my-customjs" aria-hidden="true"><span class="octicon octicon-link"></span></a>my-custom.js</h4>

<p>Your custom editor is initialized here. It's just plain javascript/jquery and you can write whatever you want to. However there are a few requirements.</p>

<div class="highlight highlight-js"><pre><span class="nx">$</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">tinyMCE</span> <span class="o">!==</span> <span class="s1">'undefined'</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// it's important to initialize only the visible textareas</span>
        <span class="nx">$</span><span class="p">(</span><span class="s1">'tr:not(.blank) .class-name'</span><span class="p">).</span><span class="nx">tinymce</span><span class="p">({});</span>
    <span class="p">}</span>
<span class="p">});</span>

<span class="c1">// executed each time an inline is added</span>
<span class="kd">function</span> <span class="nx">onAddInline</span> <span class="p">(</span><span class="nx">rows</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">tinyMCE</span> <span class="o">!==</span> <span class="s1">'undefined'</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// init tinymce editors</span>
        <span class="nx">$</span><span class="p">(</span><span class="s1">'.class-name'</span><span class="p">,</span> <span class="nx">rows</span><span class="p">).</span><span class="nx">tinymce</span><span class="p">({});</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>

<p>Here <code>class-name</code> is the same class name you specified in <code>settings.json</code> for this column.</p>

<p>The <code>tr:not(.blank) .tinymce</code> selector filter only to those textareas that have the <code>class-name</code> specified in <code>settings.json</code> but not contained inside hidden rows. You should always exclude the textareas that are inside the hidden row for an inline record. That's easy because all of them have class <code>blank</code> on their containing row.</p>

<p>The hidden textareas are initialized when they are appended to the document body. The <code>onAddInline</code> is an event like global function that is called each time an inline record is appended to the list of records. The <code>rows</code> parameters contain all table rows that's been added. Again we initialize only those textareas that have the class we specified in <code>settings.json</code>.</p><p><br /></p><hr /></div><div class="file"><h2>
<a name="editors" class="anchor" href="#editors" aria-hidden="true"><span class="octicon octicon-link"></span></a>Editors</h2>

<h3>
<a name="multiple" class="anchor" href="#multiple" aria-hidden="true"><span class="octicon octicon-link"></span></a>Multiple</h3>

<h4>
<a name="install" class="anchor" href="#install" aria-hidden="true"><span class="octicon octicon-link"></span></a>Install</h4>

<p>You should either download CKEditor and TinyMCE from their official sites <a href="http://ckeditor.com">ckedtor.com</a> and <a href="http://www.tinymce.com">tinymce.com</a> or use them directly from <a href="http://cdnjs.com">cdnjs.com</a>.</p>

<h4>
<a name="settingsjson" class="anchor" href="#settingsjson" aria-hidden="true"><span class="octicon octicon-link"></span></a>settings.json</h4>

<p>In <code>settings.json</code> add additional <code>editor</code> property to the column's <code>control</code> type key specifiyng the class name for each editor instance.</p>

<div class="highlight highlight-js"><pre><span class="s2">"control"</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">"textarea"</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="s2">"editor"</span><span class="o">:</span> <span class="s2">"ck-full"</span>
<span class="p">}</span>
</pre></div>

<div class="highlight highlight-js"><pre><span class="s2">"control"</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">"textarea"</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="s2">"editor"</span><span class="o">:</span> <span class="s2">"ck-compact"</span>
<span class="p">}</span>
</pre></div>

<div class="highlight highlight-js"><pre><span class="s2">"control"</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">"textarea"</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="s2">"editor"</span><span class="o">:</span> <span class="s2">"tinymce"</span>
<span class="p">}</span>
</pre></div>

<h4>
<a name="customjson" class="anchor" href="#customjson" aria-hidden="true"><span class="octicon octicon-link"></span></a>custom.json</h4>

<p>In <code>custom.json</code> add a unique key for your custom stuff.</p>

<div class="highlight highlight-js"><pre><span class="s2">"unique-key-here"</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">"public"</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">"external"</span><span class="o">:</span> <span class="p">{</span>
            <span class="s2">"js"</span><span class="o">:</span> <span class="p">[</span>
                <span class="s2">"//cdnjs.cloudflare.com/ajax/libs/ckeditor/4.2/ckeditor.js"</span>
            <span class="p">]</span>
        <span class="p">},</span>
        <span class="s2">"local"</span><span class="o">:</span> <span class="p">{</span>
            <span class="s2">"path"</span><span class="o">:</span> <span class="s2">"/absolute/path/to/custom/files/location"</span><span class="p">,</span>
            <span class="s2">"js"</span><span class="o">:</span> <span class="p">[</span>
                <span class="s2">"/relative/to/above/path/tinymce/jscripts/tiny_mce/tiny_mce.js"</span><span class="p">,</span>
                <span class="s2">"/relative/to/above/path/tinymce/jscripts/tiny_mce/jquery.tinymce.min.js"</span><span class="p">,</span>
                <span class="s2">"/relative/to/above/path/my-custom.js"</span>
            <span class="p">]</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>

<ul>
<li>
<strong>public</strong> - static files configuration

<ul>
<li>
<strong>path</strong> - absolute path to the static files location</li>
<li>
<strong>css</strong> - list of stylesheet files to be included</li>
<li>
<strong>js</strong> - list of javascript files to be included</li>
</ul>
</li>
</ul><h4>
<a name="my-customjs" class="anchor" href="#my-customjs" aria-hidden="true"><span class="octicon octicon-link"></span></a>my-custom.js</h4>

<p>Your custom editors are initialized here. It's just plain javascript/jquery and you can write whatever you want to. However there are a few requirements.</p>

<div class="highlight highlight-js"><pre><span class="nx">$</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">CKEDITOR</span> <span class="o">!==</span> <span class="s1">'undefined'</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">CKEDITOR</span><span class="p">.</span><span class="nx">replaceAll</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">textarea</span><span class="p">,</span> <span class="nx">config</span><span class="p">)</span> <span class="p">{</span>
            <span class="c1">// exclude textareas that are inside hidden inline rows</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="nx">textarea</span><span class="p">).</span><span class="nx">parents</span><span class="p">(</span><span class="s1">'tr'</span><span class="p">).</span><span class="nx">hasClass</span><span class="p">(</span><span class="s1">'blank'</span><span class="p">))</span> <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
            <span class="c1">// textareas with this class name will get the default configuration</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">textarea</span><span class="p">.</span><span class="nx">className</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s1">'ck-full'</span><span class="p">)</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
            <span class="c1">// textareas with this class name will have custom configuration</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">textarea</span><span class="p">.</span><span class="nx">className</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s1">'ck-compact'</span><span class="p">)</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                <span class="k">return</span> <span class="nx">setCustomConfig</span><span class="p">(</span><span class="nx">config</span><span class="p">);</span>
            <span class="c1">// all other textareas won't be initialized as ckeditors</span>
            <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
        <span class="p">});</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">tinyMCE</span> <span class="o">!==</span> <span class="s1">'undefined'</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// it's important to initialize only the visible textareas</span>
        <span class="nx">$</span><span class="p">(</span><span class="s1">'tr:not(.blank) .tinymce'</span><span class="p">).</span><span class="nx">tinymce</span><span class="p">({});</span>
    <span class="p">}</span>
<span class="p">});</span>

<span class="c1">// ckeditor only</span>
<span class="kd">function</span> <span class="nx">setCustomConfig</span> <span class="p">(</span><span class="nx">config</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">config</span> <span class="o">=</span> <span class="nx">config</span> <span class="o">||</span> <span class="p">{};</span>
    <span class="c1">// toolbar</span>
    <span class="nx">config</span><span class="p">.</span><span class="nx">toolbarGroups</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">{</span> <span class="nx">name</span><span class="o">:</span> <span class="s1">'basicstyles'</span><span class="p">,</span> <span class="nx">groups</span><span class="o">:</span> <span class="p">[</span> <span class="s1">'basicstyles'</span><span class="p">,</span> <span class="s1">'cleanup'</span> <span class="p">]</span> <span class="p">},</span>
        <span class="p">{</span> <span class="nx">name</span><span class="o">:</span> <span class="s1">'paragraph'</span><span class="p">,</span>   <span class="nx">groups</span><span class="o">:</span> <span class="p">[</span> <span class="s1">'list'</span><span class="p">,</span> <span class="s1">'indent'</span><span class="p">,</span> <span class="s1">'blocks'</span><span class="p">,</span> <span class="s1">'align'</span> <span class="p">]</span> <span class="p">},</span>
        <span class="s1">'/'</span><span class="p">,</span>
        <span class="p">{</span> <span class="nx">name</span><span class="o">:</span> <span class="s1">'styles'</span> <span class="p">},</span>
        <span class="p">{</span> <span class="nx">name</span><span class="o">:</span> <span class="s1">'colors'</span> <span class="p">}</span>
    <span class="p">];</span>
    <span class="nx">config</span><span class="p">.</span><span class="nx">removeButtons</span> <span class="o">=</span> <span class="s1">'Smiley,SpecialChar,PageBreak,Iframe,CreateDiv'</span><span class="p">;</span>
    <span class="k">return</span> <span class="nx">config</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// executed each time an inline is added</span>
<span class="kd">function</span> <span class="nx">onAddInline</span> <span class="p">(</span><span class="nx">rows</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">CKEDITOR</span> <span class="o">!==</span> <span class="s1">'undefined'</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// for each of the new rows containing textareas</span>
        <span class="nx">$</span><span class="p">(</span><span class="s1">'textarea'</span><span class="p">,</span> <span class="nx">rows</span><span class="p">).</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">index</span><span class="p">)</span> <span class="p">{</span>
            <span class="c1">// get the DOM instance</span>
            <span class="kd">var</span> <span class="nx">textarea</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">)[</span><span class="mi">0</span><span class="p">];</span>
            <span class="c1">// textareas with this class name will get the default configuration</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">textarea</span><span class="p">.</span><span class="nx">className</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s1">'ck-full'</span><span class="p">)</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">return</span> <span class="nx">CKEDITOR</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="nx">textarea</span><span class="p">);</span>
            <span class="c1">// textareas with this class name will have custom configuration</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">textarea</span><span class="p">.</span><span class="nx">className</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s1">'ck-compact'</span><span class="p">)</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                <span class="k">return</span> <span class="nx">CKEDITOR</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="nx">textarea</span><span class="p">,</span> <span class="nx">setCustomConfig</span><span class="p">());</span>
            <span class="c1">// all other textareas won't be initialized as ckeditors</span>
            <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
        <span class="p">});</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">tinyMCE</span> <span class="o">!==</span> <span class="s1">'undefined'</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// init tinymce editors</span>
        <span class="nx">$</span><span class="p">(</span><span class="s1">'.tinymce'</span><span class="p">,</span> <span class="nx">rows</span><span class="p">).</span><span class="nx">tinymce</span><span class="p">({});</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>

<p>Here based on the specific <code>class-name</code> specified in <code>settings.json</code> each textarea is initialized accordingly.</p>

<p>The <code>CKEDITOR.replaceAll</code> loop throgh all textareas on the page and filter out only those that need to be initialized as ckeditors. The most important bit is that you should always exclude the textareas that are inside the hidden row for an inline record. That's easy because all of them have class <code>blank</code> on their containing row.</p>

<p>The <code>tr:not(.blank) .tinymce</code> selector filter only to those textareas that have the <code>class-name</code> specified in <code>settings.json</code> but not contained inside hidden rows. You should always exclude the textareas that are inside the hidden row for an inline record. That's easy because all of them have class <code>blank</code> on their containing row.</p>

<p>The hidden textareas are initialized when they are appended to the document body. The <code>onAddInline</code> is an event like global function that is called each time an inline record is appended to the list of records. The <code>rows</code> parameters contain all table rows that's been added. Again we initialize all textareas according to their specific <code>class-name</code> specified in <code>settings.json</code>.</p><p><br /></p><hr /></div><div class="file"><h2>
<a name="custom-views-apps" class="anchor" href="#custom-views-apps" aria-hidden="true"><span class="octicon octicon-link"></span></a>Custom views (apps)</h2>

<p>The admin's custom views follow the <a href="http://vimeo.com/56166857">Modular web applications with Node.js and Express</a> approach presented by <a href="https://github.com/visionmedia">TJ Holowaychuk</a>.</p>

<p>The only difference here is that we're dealing with <code>mustache</code> templates.</p>

<h3>
<a name="customjson" class="anchor" href="#customjson" aria-hidden="true"><span class="octicon octicon-link"></span></a>custom.json</h3>

<div class="highlight highlight-js"><pre><span class="s2">"view1"</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">"app"</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">"path"</span><span class="o">:</span> <span class="s2">"/absolute/path/to/custom/app.js"</span><span class="p">,</span>
        <span class="s2">"slug"</span><span class="o">:</span> <span class="s2">"view1"</span><span class="p">,</span>
        <span class="s2">"verbose"</span><span class="o">:</span> <span class="s2">"My Custom View"</span><span class="p">,</span>
        <span class="s2">"mainview"</span><span class="o">:</span> <span class="p">{</span>
            <span class="s2">"show"</span><span class="o">:</span> <span class="kc">true</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>

<h3>
<a name="appjs" class="anchor" href="#appjs" aria-hidden="true"><span class="octicon octicon-link"></span></a>app.js</h3>

<div class="highlight highlight-js"><pre><span class="kd">var</span> <span class="nx">express</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'express'</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">app</span> <span class="o">=</span> <span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="nx">express</span><span class="p">();</span>
<span class="kd">var</span> <span class="nx">path</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'path'</span><span class="p">);</span>

<span class="c1">// set your custom views path</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">'views'</span><span class="p">,</span> <span class="nx">path</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="nx">__dirname</span><span class="p">,</span> <span class="s1">'views'</span><span class="p">));</span>

<span class="nx">app</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'/view1'</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">,</span> <span class="nx">next</span><span class="p">)</span> <span class="p">{</span>

    <span class="c1">// create a realtive from the admin's view folder to your custom folder</span>
    <span class="kd">var</span> <span class="nx">relative</span> <span class="o">=</span> <span class="nx">path</span><span class="p">.</span><span class="nx">relative</span><span class="p">(</span><span class="nx">res</span><span class="p">.</span><span class="nx">locals</span><span class="p">.</span><span class="nx">_admin</span><span class="p">.</span><span class="nx">views</span><span class="p">,</span> <span class="nx">app</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'views'</span><span class="p">));</span>

    <span class="nx">res</span><span class="p">.</span><span class="nx">locals</span><span class="p">.</span><span class="nx">partials</span> <span class="o">=</span> <span class="p">{</span>

        <span class="c1">// set the path to your templates like this</span>
        <span class="c1">// the content partial is declared inside the admin's base.html</span>
        <span class="c1">// this is the entry point for all your custom stuff</span>
        <span class="nx">content</span><span class="o">:</span> <span class="nx">path</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="nx">relative</span><span class="p">,</span> <span class="s1">'template'</span><span class="p">)</span>
    <span class="p">};</span>

    <span class="c1">// typically you want your stuff to be rendered inside the admin's UI</span>
    <span class="c1">// so no need to render here</span>
    <span class="nx">next</span><span class="p">();</span>
<span class="p">});</span>
</pre></div>

<p>You should definitely run the examples from the <a href="https://github.com/simov/express-admin-examples">examples repository</a> as each of the custom views (apps) presented there is really well commented.</p>

<h3>
<a name="route-wide-variables" class="anchor" href="#route-wide-variables" aria-hidden="true"><span class="octicon octicon-link"></span></a>Route wide variables</h3>

<p>Several variables are exposed to every route callback.</p>

<div class="highlight highlight-js"><pre><span class="c1">// _admin's variable content is for internal purposes only and is not being rendered</span>
<span class="nx">res</span><span class="p">.</span><span class="nx">locals</span><span class="p">.</span><span class="nx">_admin</span><span class="p">.</span><span class="nx">db</span><span class="p">.</span><span class="nx">connection</span><span class="c1">// the admin's database connection can be reused from here</span>
<span class="nx">res</span><span class="p">.</span><span class="nx">locals</span><span class="p">.</span><span class="nx">_admin</span><span class="p">.</span><span class="nx">config</span>       <span class="c1">// the contents of the config.json file</span>
<span class="nx">res</span><span class="p">.</span><span class="nx">locals</span><span class="p">.</span><span class="nx">_admin</span><span class="p">.</span><span class="nx">settings</span>     <span class="c1">// the contents of the settings.json file</span>
<span class="nx">res</span><span class="p">.</span><span class="nx">locals</span><span class="p">.</span><span class="nx">_admin</span><span class="p">.</span><span class="nx">custom</span>       <span class="c1">// the contents of the custom.json file</span>
<span class="nx">res</span><span class="p">.</span><span class="nx">locals</span><span class="p">.</span><span class="nx">_admin</span><span class="p">.</span><span class="nx">users</span>        <span class="c1">// the contents of the users.json file</span>

<span class="c1">// shortcut variables that are being rendered</span>
<span class="nx">res</span><span class="p">.</span><span class="nx">locals</span><span class="p">.</span><span class="nx">libs</span>       <span class="c1">// list of all client side libraries</span>
<span class="nx">res</span><span class="p">.</span><span class="nx">locals</span><span class="p">.</span><span class="nx">themes</span>     <span class="c1">// list of all themes</span>
<span class="nx">res</span><span class="p">.</span><span class="nx">locals</span><span class="p">.</span><span class="nx">layouts</span>    <span class="c1">// flag indicating layouts button visibility</span>
<span class="nx">res</span><span class="p">.</span><span class="nx">locals</span><span class="p">.</span><span class="nx">languages</span>  <span class="c1">// list of all languages</span>

<span class="c1">// holds the absolute path to the admin's view directory</span>
<span class="nx">res</span><span class="p">.</span><span class="nx">locals</span><span class="p">.</span><span class="nx">_admin</span><span class="p">.</span><span class="nx">views</span>
</pre></div><p><br /></p><hr /></div><div class="file"><h2>
<a name="events" class="anchor" href="#events" aria-hidden="true"><span class="octicon octicon-link"></span></a>Events</h2>

<p>Currently the supported event hooks are:</p>

<ul>
<li>
<strong>preSave</strong> - before a record is saved</li>
<li>
<strong>postSave</strong> - after a record is saved</li>
<li>
<strong>preList</strong> - before listview is shown</li>
</ul><h3>
<a name="customjson" class="anchor" href="#customjson" aria-hidden="true"><span class="octicon octicon-link"></span></a>custom.json</h3>

<div class="highlight highlight-js"><pre><span class="s2">"some-key"</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">"events"</span><span class="o">:</span> <span class="s2">"/absolute/path/to/custom/events.js"</span>
<span class="p">}</span>
</pre></div>

<h3>
<a name="eventsjs" class="anchor" href="#eventsjs" aria-hidden="true"><span class="octicon octicon-link"></span></a>events.js</h3>

<p>Run the admin with the <code>--debug-brk</code> flag and use <a href="https://github.com/node-inspector/node-inspector">node-inspector</a> to drill down into the event hook parameters</p>

<div class="highlight highlight-js"><pre><span class="nx">exports</span><span class="p">.</span><span class="nx">preSave</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">,</span> <span class="nx">args</span><span class="p">,</span> <span class="nx">next</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">args</span><span class="p">.</span><span class="nx">debug</span><span class="p">)</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'preSave'</span><span class="p">);</span>
    <span class="kr">debugger</span><span class="p">;</span>
    <span class="nx">next</span><span class="p">();</span>
<span class="p">}</span>
<span class="nx">exports</span><span class="p">.</span><span class="nx">postSave</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">,</span> <span class="nx">args</span><span class="p">,</span> <span class="nx">next</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">args</span><span class="p">.</span><span class="nx">debug</span><span class="p">)</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'postSave'</span><span class="p">);</span>
    <span class="kr">debugger</span><span class="p">;</span>
    <span class="nx">next</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>

<p>Take a look at the event examples <a href="https://github.com/simov/express-admin-examples/blob/master/config/custom/events/events.js">here</a> and <a href="https://github.com/simov/express-admin-tests/blob/master/config/x-relationships-compound/custom/events.js">here</a></p>

<h3>
<a name="presave-args" class="anchor" href="#presave-args" aria-hidden="true"><span class="octicon octicon-link"></span></a>preSave args</h3>

<ul>
<li>
<strong>action</strong> - <code>insert|update|remove</code>
</li>
<li>
<strong>name</strong> - this table's name</li>
<li>
<strong>slug</strong> - this table's slug</li>
<li>
<p><strong>data</strong> - data submitted via POST request or select'ed from the database</p>

<ul>
<li>
<strong>view</strong> - this table's data (the one currently shown inside the <em>editview</em>)</li>
<li>
<p><strong>oneToOne | manyToOne</strong> - inline tables data</p>

<div class="highlight highlight-js"><pre><span class="s2">"table's name"</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">"records"</span><span class="o">:</span> <span class="p">[</span>
        <span class="s2">"columns"</span><span class="o">:</span> <span class="p">{</span><span class="s2">"column's name"</span><span class="o">:</span> <span class="s2">"column's value"</span><span class="p">,</span> <span class="p">...},</span>
        <span class="s2">"insert|update|remove"</span><span class="o">:</span> <span class="s2">"true"</span> <span class="c1">// only for inline records</span>
    <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</li>
</ul>
</li>
<li>
<strong>upath</strong> - absolute path to the upload folder location</li>
<li>
<strong>upload</strong> - list of files submitted via POST request</li>
<li>
<strong>db</strong> - database connection instance</li>
</ul><h4>
<a name="examples" class="anchor" href="#examples" aria-hidden="true"><span class="octicon octicon-link"></span></a>examples</h4>

<h5>
<a name="created_at--updated_at" class="anchor" href="#created_at--updated_at" aria-hidden="true"><span class="octicon octicon-link"></span></a><em>created_at / updated_at</em>
</h5>

<ul>
<li>in this example our table will be called <code>user</code>
</li>
<li>the <code>created_at</code> and <code>update_at</code> columns in <code>user</code> table should be set to <code>show: false</code> for <code>editview</code> in <code>settings.json</code>
</li>
<li>use the code below to set the <code>created_at</code> and <code>updated_at</code> columns, before the record is saved</li>
</ul><div class="highlight highlight-js"><pre><span class="kd">var</span> <span class="nx">moment</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'moment'</span><span class="p">);</span>

<span class="nx">exports</span><span class="p">.</span><span class="nx">preSave</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">,</span> <span class="nx">args</span><span class="p">,</span> <span class="nx">next</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">args</span><span class="p">.</span><span class="nx">name</span> <span class="o">==</span> <span class="s1">'user'</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">now</span> <span class="o">=</span> <span class="nx">moment</span><span class="p">(</span><span class="k">new</span> <span class="nb">Date</span><span class="p">()).</span><span class="nx">format</span><span class="p">(</span><span class="s1">'YYYY-MM-DD hh:mm:ss'</span><span class="p">),</span>
            <span class="nx">record</span> <span class="o">=</span> <span class="nx">args</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">view</span><span class="p">.</span><span class="nx">user</span><span class="p">.</span><span class="nx">records</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">columns</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">args</span><span class="p">.</span><span class="nx">action</span> <span class="o">==</span> <span class="s1">'insert'</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">record</span><span class="p">.</span><span class="nx">created_at</span> <span class="o">=</span> <span class="nx">now</span><span class="p">;</span>
            <span class="nx">record</span><span class="p">.</span><span class="nx">updated_at</span> <span class="o">=</span> <span class="nx">now</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">args</span><span class="p">.</span><span class="nx">action</span> <span class="o">==</span> <span class="s1">'update'</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">record</span><span class="p">.</span><span class="nx">updated_at</span> <span class="o">=</span> <span class="nx">now</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="nx">next</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>

<h5>
<a name="generate-hash-id" class="anchor" href="#generate-hash-id" aria-hidden="true"><span class="octicon octicon-link"></span></a><em>generate hash id</em>
</h5>

<ul>
<li>in this example our table will be called <code>car</code> and will contain <code>manyToOne</code> inline tables</li>
<li>the car's table primary key that needs to be generated (in this case it's called <code>id</code>) should be set to <code>show: false</code> for <code>editview</code> in <code>settings.json</code> (the same applies for any inline table that needs its primary key to be generated)</li>
<li>use the code below to set the columns that needs to be generated, before the record is saved</li>
</ul><div class="highlight highlight-js"><pre><span class="kd">var</span> <span class="nx">shortid</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'shortid'</span><span class="p">);</span>

<span class="nx">exports</span><span class="p">.</span><span class="nx">preSave</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">,</span> <span class="nx">args</span><span class="p">,</span> <span class="nx">next</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">args</span><span class="p">.</span><span class="nx">name</span> <span class="o">==</span> <span class="s1">'car'</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">args</span><span class="p">.</span><span class="nx">action</span> <span class="o">==</span> <span class="s1">'insert'</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">table</span> <span class="o">=</span> <span class="nx">args</span><span class="p">.</span><span class="nx">name</span><span class="p">,</span>
                <span class="nx">record</span> <span class="o">=</span> <span class="nx">args</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">view</span><span class="p">[</span><span class="nx">table</span><span class="p">].</span><span class="nx">records</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">columns</span><span class="p">;</span>
            <span class="nx">record</span><span class="p">.</span><span class="nx">id</span> <span class="o">=</span> <span class="nx">shortid</span><span class="p">.</span><span class="nx">generate</span><span class="p">();</span>
        <span class="p">}</span>
        <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">table</span> <span class="k">in</span> <span class="nx">args</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">manyToOne</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">inline</span> <span class="o">=</span> <span class="nx">args</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">manyToOne</span><span class="p">[</span><span class="nx">table</span><span class="p">];</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">inline</span><span class="p">.</span><span class="nx">records</span><span class="p">)</span> <span class="k">continue</span><span class="p">;</span>
            <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">inline</span><span class="p">.</span><span class="nx">records</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">inline</span><span class="p">.</span><span class="nx">records</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">insert</span> <span class="o">!=</span> <span class="s1">'true'</span><span class="p">)</span> <span class="k">continue</span><span class="p">;</span>
                <span class="nx">inline</span><span class="p">.</span><span class="nx">records</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">columns</span><span class="p">.</span><span class="nx">id</span> <span class="o">=</span> <span class="nx">shortid</span><span class="p">.</span><span class="nx">generate</span><span class="p">();</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="nx">next</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>

<h5>
<a name="soft-delete-records" class="anchor" href="#soft-delete-records" aria-hidden="true"><span class="octicon octicon-link"></span></a><em>soft delete records</em>
</h5>

<ul>
<li>in this example our table will be called <code>purchase</code> and will contain <code>manyToOne</code> inline tables</li>
<li>the purchase's table <code>deleted</code> and <code>deleted_at</code> columns should be set to <code>show: false</code> for <code>editview</code> in <code>settings.json</code>
</li>
<li>use the code below to set the <code>deleted</code> and <code>deleted_at</code> columns, before the record is saved</li>
</ul><div class="highlight highlight-js"><pre><span class="kd">var</span> <span class="nx">moment</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'moment'</span><span class="p">);</span>

<span class="nx">exports</span><span class="p">.</span><span class="nx">preSave</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">,</span> <span class="nx">args</span><span class="p">,</span> <span class="nx">next</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">args</span><span class="p">.</span><span class="nx">name</span> <span class="o">==</span> <span class="s1">'purchase'</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">now</span> <span class="o">=</span> <span class="nx">moment</span><span class="p">(</span><span class="k">new</span> <span class="nb">Date</span><span class="p">()).</span><span class="nx">format</span><span class="p">(</span><span class="s1">'YYYY-MM-DD hh:mm:ss'</span><span class="p">);</span>
        <span class="c1">// all inline oneToOne and manyToOne records should be marked as deleted</span>
        <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">table</span> <span class="k">in</span> <span class="nx">args</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">manyToOne</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">inline</span> <span class="o">=</span> <span class="nx">args</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">manyToOne</span><span class="p">[</span><span class="nx">table</span><span class="p">];</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">inline</span><span class="p">.</span><span class="nx">records</span><span class="p">)</span> <span class="k">continue</span><span class="p">;</span>
            <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">inline</span><span class="p">.</span><span class="nx">records</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">args</span><span class="p">.</span><span class="nx">action</span> <span class="o">!=</span> <span class="s1">'remove'</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">inline</span><span class="p">.</span><span class="nx">records</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">remove</span><span class="p">)</span> <span class="k">continue</span><span class="p">;</span>
                <span class="c1">// instead of deleting the record</span>
                <span class="k">delete</span> <span class="nx">inline</span><span class="p">.</span><span class="nx">records</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">remove</span><span class="p">;</span>
                <span class="c1">// update it</span>
                <span class="nx">inline</span><span class="p">.</span><span class="nx">records</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">columns</span><span class="p">.</span><span class="nx">deleted</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
                <span class="nx">inline</span><span class="p">.</span><span class="nx">records</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">columns</span><span class="p">.</span><span class="nx">deleted_at</span> <span class="o">=</span> <span class="nx">now</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="c1">// parent record</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">args</span><span class="p">.</span><span class="nx">action</span> <span class="o">==</span> <span class="s1">'remove'</span><span class="p">)</span> <span class="p">{</span>
            <span class="c1">// instead of deleting the record</span>
            <span class="nx">args</span><span class="p">.</span><span class="nx">action</span> <span class="o">=</span> <span class="s1">'update'</span><span class="p">;</span>
            <span class="c1">// update it</span>
            <span class="kd">var</span> <span class="nx">record</span> <span class="o">=</span> <span class="nx">args</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">view</span><span class="p">.</span><span class="nx">purchase</span><span class="p">.</span><span class="nx">records</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">columns</span><span class="p">;</span>
            <span class="nx">record</span><span class="p">.</span><span class="nx">deleted</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
            <span class="nx">record</span><span class="p">.</span><span class="nx">deleted_at</span> <span class="o">=</span> <span class="nx">now</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="nx">next</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>

<h3>
<a name="postsave-args" class="anchor" href="#postsave-args" aria-hidden="true"><span class="octicon octicon-link"></span></a>postSave args</h3>

<ul>
<li>
<strong>action</strong> - <code>insert|update|remove</code>
</li>
<li>
<strong>name</strong> - this table's name</li>
<li>
<strong>slug</strong> - this table's slug</li>
<li>
<strong>data</strong> - data submitted via POST request or select'ed from the database

<ul>
<li>
<strong>view</strong> - this table's data (the one currently shown inside the <em>editview</em>)</li>
<li>
<strong>oneToOne | manyToOne</strong> - inline tables data

<div class="highlight highlight-js"><pre><span class="s2">"table's name"</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">"records"</span><span class="o">:</span> <span class="p">[</span>
        <span class="s2">"columns"</span><span class="o">:</span> <span class="p">{</span><span class="s2">"column's name"</span><span class="o">:</span> <span class="s2">"column's value"</span><span class="p">,</span> <span class="p">...},</span>
        <span class="s2">"insert|update|remove"</span><span class="o">:</span> <span class="s2">"true"</span> <span class="c1">// only for inline records</span>
    <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</li>
</ul>
</li>
<li>
<strong>upath</strong> - absolute path to the upload folder location</li>
<li>
<strong>upload</strong> - list of files submitted via POST request</li>
<li>
<strong>db</strong> - database connection instance</li>
</ul><h4>
<a name="examples-1" class="anchor" href="#examples-1" aria-hidden="true"><span class="octicon octicon-link"></span></a>examples</h4>

<h5>
<a name="upload-files-to-a-third-party-server" class="anchor" href="#upload-files-to-a-third-party-server" aria-hidden="true"><span class="octicon octicon-link"></span></a><em>upload files to a third party server</em>
</h5>

<ul>
<li>in this example our table will be called <code>item</code>
</li>
<li>the item's table <code>image</code>'s column control type should be set to <code>file:true</code> in <code>settings.json</code>
</li>
<li>use the code below to upload the image, after the record is saved</li>
</ul><div class="highlight highlight-js"><pre><span class="kd">var</span> <span class="nx">cloudinary</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'cloudinary'</span><span class="p">),</span>
    <span class="nx">fs</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'fs'</span><span class="p">),</span>
    <span class="nx">path</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'path'</span><span class="p">);</span>
<span class="nx">cloudinary</span><span class="p">.</span><span class="nx">config</span><span class="p">({</span>
    <span class="nx">cloud_name</span><span class="o">:</span> <span class="s1">''</span><span class="p">,</span>
    <span class="nx">api_key</span><span class="o">:</span> <span class="s1">''</span><span class="p">,</span>
    <span class="nx">api_secret</span><span class="o">:</span> <span class="s1">''</span>
<span class="p">});</span>
<span class="nx">exports</span><span class="p">.</span><span class="nx">postSave</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">,</span> <span class="nx">args</span><span class="p">,</span> <span class="nx">next</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">args</span><span class="p">.</span><span class="nx">name</span> <span class="o">==</span> <span class="s1">'item'</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// file upload control data</span>
        <span class="kd">var</span> <span class="nx">image</span> <span class="o">=</span> <span class="nx">args</span><span class="p">.</span><span class="nx">upload</span><span class="p">.</span><span class="nx">view</span><span class="p">.</span><span class="nx">item</span><span class="p">.</span><span class="nx">records</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">columns</span><span class="p">.</span><span class="nx">image</span><span class="p">;</span>
        <span class="c1">// in case file is chosen through the file input control</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">image</span><span class="p">.</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
            <span class="c1">// file name of the image already uploaded to the upload folder</span>
            <span class="kd">var</span> <span class="nx">fname</span> <span class="o">=</span> <span class="nx">args</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">view</span><span class="p">.</span><span class="nx">item</span><span class="p">.</span><span class="nx">records</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">columns</span><span class="p">.</span><span class="nx">image</span><span class="p">;</span>
            <span class="c1">// upload</span>
            <span class="kd">var</span> <span class="nx">fpath</span> <span class="o">=</span> <span class="nx">path</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="nx">args</span><span class="p">.</span><span class="nx">upath</span><span class="p">,</span> <span class="nx">fname</span><span class="p">);</span>
            <span class="nx">cloudinary</span><span class="p">.</span><span class="nx">uploader</span><span class="p">.</span><span class="nx">upload</span><span class="p">(</span><span class="nx">fpath</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">result</span><span class="p">);</span>
                <span class="nx">next</span><span class="p">();</span>
            <span class="p">});</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="nx">next</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="nx">next</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>

<h3>
<a name="prelist-args" class="anchor" href="#prelist-args" aria-hidden="true"><span class="octicon octicon-link"></span></a>preList args</h3>

<ul>
<li>
<strong>name</strong> - this table's name</li>
<li>
<strong>slug</strong> - this table's slug</li>
<li>
<strong>filter</strong> - filter data submitted via POST request

<ul>
<li>
<strong>columns</strong> - list of columns (and their values) to filter by</li>
<li>
<strong>direction</strong> - sort order direction</li>
<li>
<strong>order</strong> - column names by which to order</li>
<li>
<strong>or</strong> - <code>true|false</code> whether to use logical <em>or</em> or not</li>
</ul>
</li>
<li>
<strong>statements</strong> - sql query strings partials

<ul>
<li>
<strong>columns</strong> - columns to select</li>
<li>
<strong>table</strong> - table to select from</li>
<li>
<strong>join</strong> - join statements</li>
<li>
<strong>where</strong> - where statements</li>
<li>
<strong>group</strong> - group by statements</li>
<li>
<strong>order</strong> - order statements</li>
<li>
<strong>from</strong> - limit from number</li>
<li>
<strong>to</strong> - limit to number</li>
</ul>
</li>
<li>
<strong>db</strong> - database connection instance</li>
</ul><h4>
<a name="examples-2" class="anchor" href="#examples-2" aria-hidden="true"><span class="octicon octicon-link"></span></a>examples</h4>

<h5>
<a name="soft-deleted-records" class="anchor" href="#soft-deleted-records" aria-hidden="true"><span class="octicon octicon-link"></span></a><em>soft deleted records</em>
</h5>

<ul>
<li>check out the <em>preSave</em> example about <em>soft deleted records</em> above</li>
</ul><div class="highlight highlight-js"><pre><span class="nx">exports</span><span class="p">.</span><span class="nx">preList</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">,</span> <span class="nx">args</span><span class="p">,</span> <span class="nx">next</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">args</span><span class="p">.</span><span class="nx">name</span> <span class="o">==</span> <span class="s1">'purchase'</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// check if we're using listview's filter</span>
        <span class="c1">// and actually want to see soft deleted records</span>
        <span class="kd">var</span> <span class="nx">filter</span> <span class="o">=</span> <span class="nx">args</span><span class="p">.</span><span class="nx">filter</span><span class="p">.</span><span class="nx">columns</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">filter</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nx">filter</span><span class="p">.</span><span class="nx">deleted</span><span class="o">==</span><span class="s1">'1'</span> <span class="o">||</span> <span class="nx">filter</span><span class="p">.</span><span class="nx">deleted_at</span> <span class="o">&amp;&amp;</span> <span class="nx">filter</span><span class="p">.</span><span class="nx">deleted_at</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">next</span><span class="p">();</span>
        <span class="p">}</span>
        <span class="c1">// otherwise hide the soft deleted records by default</span>
        <span class="kd">var</span> <span class="nx">filter</span> <span class="o">=</span> 
            <span class="s1">' `purchase`.`deleted` IS NULL OR `purchase`.`deleted` = 0'</span> <span class="o">+</span>
            <span class="s1">' OR `purchase`.`deleted_at` IS NULL '</span><span class="p">;</span>
        <span class="nx">args</span><span class="p">.</span><span class="nx">statements</span><span class="p">.</span><span class="nx">where</span>
            <span class="o">?</span> <span class="nx">args</span><span class="p">.</span><span class="nx">statements</span><span class="p">.</span><span class="nx">where</span> <span class="o">+=</span> <span class="s1">' AND '</span> <span class="o">+</span> <span class="nx">filter</span>
            <span class="o">:</span> <span class="nx">args</span><span class="p">.</span><span class="nx">statements</span><span class="p">.</span><span class="nx">where</span> <span class="o">=</span> <span class="s1">' WHERE '</span> <span class="o">+</span> <span class="nx">filter</span>
    <span class="p">}</span>
    <span class="nx">next</span><span class="p">();</span>
<span class="p">}</span>
</pre></div><p><br /></p><hr /></div><div class="file"><h2>
<a name="embedding" class="anchor" href="#embedding" aria-hidden="true"><span class="octicon octicon-link"></span></a>Embedding</h2>

<p>You need to add one additional property inside your <code>config.json</code> file under the <code>app</code> key</p>

<h3>
<a name="configjson" class="anchor" href="#configjson" aria-hidden="true"><span class="octicon octicon-link"></span></a>config.json</h3>

<div class="highlight highlight-js"><pre><span class="s2">"app"</span><span class="o">:</span> <span class="p">{</span>
    <span class="p">...</span>
    <span class="s2">"root"</span><span class="o">:</span> <span class="s2">"/some-path"</span>
<span class="p">}</span>
</pre></div>

<h3>
<a name="initialization" class="anchor" href="#initialization" aria-hidden="true"><span class="octicon octicon-link"></span></a>Initialization</h3>

<p>In this example Express Admin will be located under the <code>/admin</code> path of your app</p>

<div class="highlight highlight-js"><pre><span class="kd">var</span> <span class="nx">express</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'express'</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">expressAdmin</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'express-admin'</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">app</span> <span class="o">=</span> <span class="nx">express</span><span class="p">();</span>

<span class="nx">app</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'/'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">){</span>
    <span class="nx">res</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="s1">'Hello World'</span><span class="p">);</span>
<span class="p">});</span>

<span class="kd">var</span> <span class="nx">expressAdminArgs</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">dpath</span><span class="o">:</span> <span class="s1">'./express-admin-config/'</span><span class="p">,</span>
    <span class="nx">config</span><span class="o">:</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'./express-admin-config/config.json'</span><span class="p">),</span>
    <span class="nx">settings</span><span class="o">:</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'./express-admin-config/settings.json'</span><span class="p">),</span>
    <span class="nx">custom</span><span class="o">:</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'./express-admin-config/custom.json'</span><span class="p">),</span>
    <span class="nx">users</span><span class="o">:</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'./express-admin-config/users.json'</span><span class="p">)</span>
<span class="p">};</span>

<span class="nx">expressAdmin</span><span class="p">.</span><span class="nx">initDatabase</span><span class="p">(</span><span class="nx">expressAdminArgs</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="k">return</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">err</span><span class="p">);</span>

    <span class="nx">expressAdmin</span><span class="p">.</span><span class="nx">initSettings</span><span class="p">(</span><span class="nx">expressAdminArgs</span><span class="p">);</span>

    <span class="kd">var</span> <span class="nx">admin</span> <span class="o">=</span> <span class="nx">expressAdmin</span><span class="p">.</span><span class="nx">initServer</span><span class="p">(</span><span class="nx">expressAdminArgs</span><span class="p">);</span>
    <span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="s1">'/admin'</span><span class="p">,</span> <span class="nx">admin</span><span class="p">);</span>
    <span class="nx">app</span><span class="p">.</span><span class="nx">listen</span><span class="p">(</span><span class="mi">3000</span><span class="p">);</span>
<span class="p">});</span>
</pre></div><p><br /></p><hr /></div><div class="file"><h2>
<a name="themes" class="anchor" href="#themes" aria-hidden="true"><span class="octicon octicon-link"></span></a>Themes</h2>

<p>Use the <code>Themes</code> button to switch between the themes.</p><p><br /></p><hr /></div><div class="file"><h2>
<a name="tools" class="anchor" href="#tools" aria-hidden="true"><span class="octicon octicon-link"></span></a>Tools</h2>

<h3>
<a name="shell" class="anchor" href="#shell" aria-hidden="true"><span class="octicon octicon-link"></span></a>Shell</h3>

<h4>
<a name="debugging" class="anchor" href="#debugging" aria-hidden="true"><span class="octicon octicon-link"></span></a>Debugging</h4>

<p>Set a <code>breakpoint</code> somewhere inside your custom view files and debug as usual.</p>

<div class="highlight highlight-bash"><pre><span class="nv">$ </span>admin --debug-brk path/to/project/config/
<span class="c"># or</span>
<span class="nv">$ </span>node --debug-brk path/to/express-admin/app path/to/project/config/
</pre></div>

<h4>
<a name="supervisor" class="anchor" href="#supervisor" aria-hidden="true"><span class="octicon octicon-link"></span></a>Supervisor</h4>

<p>Auto reload your project while configuring it using <a href="https://github.com/isaacs/node-supervisor">supervisior</a>.</p>

<p>Create a folder for your project's configuration files.</p>

<div class="highlight highlight-bash"><pre><span class="nv">$ </span>mkdir project
</pre></div>

<p>Then while you're still there you can use <code>supervisor</code> to watch your <code>project</code> folder, specifying that the extensions are <code>json</code>.</p>

<div class="highlight highlight-bash"><pre><span class="nv">$ </span>supervisor -w project -e json -- path/to/express-admin/app -v project/
</pre></div>

<p>The <code>-v</code> flag that you're passing to the Express Admin app means that you are running the admin in <code>development</code> mode. In this mode the authentication and the database record updates are disabled.</p>

<p>You can also pass the <code>-l</code> flag which will log out all sql queries that Express Admin make for you.</p>

<h4>
<a name="forever" class="anchor" href="#forever" aria-hidden="true"><span class="octicon octicon-link"></span></a>Forever</h4>

<p>Run an admin instance continuously in the background using <a href="https://github.com/nodejitsu/forever">forever</a>.</p>

<div class="highlight highlight-bash"><pre><span class="nv">$ </span>forever start path/to/express-admin/app path/to/project/config/
</pre></div><p><br /></p><hr /></div><div class="file"><h2>
<a name="tools" class="anchor" href="#tools" aria-hidden="true"><span class="octicon octicon-link"></span></a>Tools</h2>

<h3>
<a name="nginx" class="anchor" href="#nginx" aria-hidden="true"><span class="octicon octicon-link"></span></a>NginX</h3>

<p>You can serve all your static files with <a href="http://nginx.org/en/">NginX</a>.</p>

<div class="highlight highlight-bash"><pre>server <span class="o">{</span>
    listen 80<span class="p">;</span>

    <span class="c"># vhost</span>
    server_name admin.example.com<span class="p">;</span>

    <span class="c">#log</span>
    access_log /var/log/nginx/admin-access.log<span class="p">;</span>
    error_log /var/log/nginx/admin-error.log debug<span class="p">;</span>

    <span class="c"># NODE</span>
    location / <span class="o">{</span>
        proxy_pass http://127.0.0.1:3000<span class="p">;</span>
        proxy_set_header Host <span class="nv">$http_host</span><span class="p">;</span>
        proxy_set_header X-Real-IP <span class="nv">$remote_addr</span><span class="p">;</span>
        proxy_set_header X-Forwarded-For <span class="nv">$proxy_add_x_forwarded_for</span><span class="p">;</span>
    <span class="o">}</span>

    <span class="c"># NGINX</span>

    <span class="c"># static</span>
    location ~ <span class="se">\.</span><span class="o">(</span>jpg<span class="p">|</span>jpeg<span class="p">|</span>png<span class="p">|</span>gif<span class="p">|</span>swf<span class="p">|</span>flv<span class="p">|</span>mp4<span class="p">|</span>mov<span class="p">|</span>avi<span class="p">|</span>wmv<span class="p">|</span>m4v<span class="p">|</span>mkv<span class="p">|</span>ico<span class="p">|</span>css<span class="p">|</span>js<span class="p">|</span>txt<span class="p">|</span>html<span class="p">|</span>htm<span class="o">)</span><span class="nv">$ </span><span class="o">{</span>
        root /<span class="p">;</span>
        try_files
            <span class="c"># express admin</span>
            /absolute/path/to/express-admin/public/<span class="nv">$uri</span>

            <span class="c"># custom views</span>
            /absolute/path/to/your/project/custom/app1/public/<span class="nv">$uri</span>
            /absolute/path/to/your/project/custom/app2/public/<span class="nv">$uri</span>
        /<span class="p">;</span>
    <span class="o">}</span>

    <span class="c"># LIBS</span>

    <span class="c"># csslib</span>
    location ^~ /csslib/ <span class="o">{</span>
        <span class="nb">alias</span> /absolute/path/to/express-admin/node_modules/express-admin-static/csslib/<span class="p">;</span>
    <span class="o">}</span>
    <span class="c"># jslib</span>
    location ^~ /jslib/ <span class="o">{</span>
        <span class="nb">alias</span> /absolute/path/to/express-admin/node_modules/express-admin-static/jslib/<span class="p">;</span>
    <span class="o">}</span>
    <span class="c"># bootswatch</span>
    location ^~ /bootswatch/ <span class="o">{</span>
        <span class="nb">alias</span> /absolute/path/to/express-admin/node_modules/express-admin-static/bootswatch/<span class="p">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div><p><br /></p><hr /></div><div class="file"><h2>
<a name="tools" class="anchor" href="#tools" aria-hidden="true"><span class="octicon octicon-link"></span></a>Tools</h2>

<h3>
<a name="apache" class="anchor" href="#apache" aria-hidden="true"><span class="octicon octicon-link"></span></a>Apache</h3>

<p>If some of your custom view's requests need to be handled by <a href="http://httpd.apache.org/">Apache</a>, add this to the nginx vhost file.</p>

<div class="highlight highlight-bash"><pre><span class="c"># apache</span>
location /some-slug/ <span class="o">{</span>
    proxy_pass http://127.0.0.1:8008/some-slug/<span class="p">;</span>
    proxy_set_header Host <span class="nv">$http_host</span><span class="p">;</span>
    proxy_set_header X-Real-IP <span class="nv">$remote_addr</span><span class="p">;</span>
    proxy_set_header X-Forwarded-For <span class="nv">$proxy_add_x_forwarded_for</span><span class="p">;</span>
<span class="o">}</span>
</pre></div>

<p>Edit <code>/etc/apache2/ports.conf</code>.</p>

<div class="highlight highlight-bash"><pre><span class="c"># When nginx is set as proxy</span>
NameVirtualHost 127.0.0.1:8008
Listen 127.0.0.1:8008
</pre></div>

<p>Create apache's virtual host file.</p>

<div class="highlight highlight-bash"><pre>&lt;VirtualHost 127.0.0.1:8008&gt;
    ServerAdmin admin@localhost
    <span class="c"># apache's vhost name MUST MATCH the nginx's vhost name</span>
    ServerName admin.example.com
    ServerAlias admin.example.com
    <span class="c"># some aliases etc.</span>
    Alias /some-slug /path/to/some/dir
    &lt;Location /some-slug&gt;
        <span class="c"># some options ...</span>
    &lt;/Location&gt;
    <span class="c"># log</span>
    ErrorLog /var/log/apache2/admin-error.log
    CustomLog /var/log/apache2/admin-access.log combined
&lt;/VirtualHost&gt;
</pre></div></div>				</article>
            </section>
            
        </div>

        <nav id="navigation" class="repository-sidebar">
            <ul>
                <li><a href="#express-admin">Express Admin</a></li>
                <li><a href="#install">Install</a></li>
                <li><a href="#configuration">Configuration</a>
                    <ul>
                        <li><a href="#configjson">config.json</a></li>
                        <li><a href="#settingsjson">settings.json</a></li>
                        <li><a href="#customjson">custom.json</a></li>
                    </ul>
                </li>
                <li><a href="#relationships">Relationships</a>
                    <ul>
                        <li><a href="#one-to-many">one to many</a></li>
                        <li><a href="#many-to-many">many to many</a></li>
                        <li><a href="#many-to-one">many to one</a></li>
                        <li><a href="#one-to-one">one to one</a></li>
                    </ul>
                </li>
                <li><a href="#compound-primary-key">Compound PK</a></li>
                <li><a href="#editors">Editors</a>
                    <ul>
                        <li><a href="#ckeditor">ckeditor</a></li>
                        <li><a href="#tinymce">tinymce</a></li>
                        <li><a href="#multiple">multiple</a></li>
                    </ul>
                </li>
                <li><a href="#custom-views-apps">Custom</a>
                    <ul>
                        <li><a href="#custom-views-apps">Views (Apps)</a></li>
                        <li><a href="#events">Events</a></li>
                        <li><a href="#embedding">Embedding</a></li>
                    </ul>
                </li>
                <li><a href="#themes">Themes</a></li>
                <li><a href="#tools">Tools</a>
                    <ul>
                        <li><a href="#shell">shell</a></li>
                        <li><a href="#nginx">nginx</a></li>
                        <li><a href="#apache">apache</a></li>
                    </ul>
                </li>
            </ul>
        </nav>
    </div>

    <a href="https://github.com/simov/express-admin" id="forkme-badge"><img style="position: fixed; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png" alt="Fork me on GitHub"></a>

</div>
</body>
</html>